(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],[,,,,,,,,,,function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),s=n(4),i=n.n(s),a=(n(10),n(2)),l=(n(11),n(0));var o=function(e){var t=e.rank,n=e.onRowClick,r=Object(c.useRef)(0),s=Object(c.useRef)();return Object(c.useEffect)((function(){return setInterval((function(){s.current&&s.current.parentNode.classList.toggle("rank-top")}),1e3),function(){return clearInterval(r.current)}}),[]),Object(l.jsxs)("div",{className:"rank-row",onClick:function(e){var t=e.currentTarget.querySelector("div.rank-name");n(t.textContent)},children:[Object(l.jsx)("div",{className:"rank-rank",children:t.rank}),Object(l.jsx)("div",{className:"rank-name",children:t.name}),Object(l.jsx)("div",{className:"rank-score",children:"".concat(t.score," ( ").concat(t.level," )")}),Object(l.jsx)("div",{className:"rank-date",children:t.reg_dt}),t.link?Object(l.jsx)("div",{style:{margin:"0 auto"}}):null,t.link?Object(l.jsx)("img",{src:t.link,ref:s,style:{width:"25px"}}):null]})};var d=function(e){var t=e.item;return Object(l.jsxs)("div",{className:"rank-his-row",children:[Object(l.jsx)("div",{style:{width:"150px",textAlign:"left"},children:"".concat(t.score," ( ").concat(t.level," )")}),Object(l.jsx)("div",{children:t.reg_dt})]})},u={uuid:function(){var e=0,t=new Date,n=t.toLocaleString().split("."),c=t.toTimeString().split(":");return e=n[1].trim().length,n[1]=1===e?"0"+n[1].trim():n[1].trim(),e=n[2].trim().length,n[2]=1===e?"0"+n[2].trim():n[2].trim(),n[0]+n[1]+n[2]+"-"+c[0]+c[1]+t.getSeconds()+"-"+u.rand(100)},rand:function(e){if(isNaN(e))return 0;var t=Math.pow(10,Number((""+e).length));return(Math.random()*t%e).toFixed()},request:function(e,t){var n=e.url,c=e.body,r=void 0===c?{}:c,s=e.method,i=void 0===s?"POST":s;if(n){var a={method:i,credentials:"same-origin",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector("meta[name=_csrf]").content}};"post"===i.toLowerCase()&&(a.body=JSON.stringify(r)),u.showLoadMask(!0),fetch("/api/"+n,a).then((function(e){return u.showLoadMask(!1),200===e.status?e.json():{}})).then((function(e){var n={errMsg:e.error,result:e.rows,data:e.data||e};t&&"function"===typeof t&&t(n)})).catch((function(e){console.error(e)}))}},showLoadMask:function(e){var t=document.querySelector("#modal");if(e){if(0!==document.querySelectorAll("div.modal-back").length)return;var n=document.createElement("div"),c=document.createElement("div");n.classList.add("modal-back"),c.classList.add("mask"),t.appendChild(n),n.appendChild(c);for(var r=1;r<=8;r++){var s=document.createElement("div");s.classList.add("dot"+r),s.classList.add("dotcol-"+r),c.appendChild(s)}window.modalIntervalId=setInterval((function(){for(var e=document.querySelectorAll('div.modal-back div[class*="dot"]'),t=0;t<e.length;t++){var n=e[t].classList.item(1),c=Number(n.split("-")[1]);c=c+1>8?1:c+1,e[t].classList.remove(n),e[t].classList.add("dotcol-"+c)}}),80)}else t.firstChild&&(clearInterval(window.modalIntervalId),t.removeChild(t.firstChild))},alert:function(e,t){u.makeDialog(!1,e,[t])},confirm:function(e,t,n){u.makeDialog(!0,e,[t,n])},makeDialog:function(e,t,n){var c=Object(a.a)(n,2),r=c[0],s=c[1],i=document.querySelector("#modal");if(0===document.querySelectorAll("div.modal-back").length){var l=document.createElement("div"),o=document.createElement("div"),d=document.createElement("div"),u=document.createElement("div"),b=document.createElement("div");if(l.classList.add("modal-back"),o.classList.add("dialog"),d.classList.add("dialog-msg-box"),u.classList.add("dialog-btn-box"),b.classList.add("dialog-btn-1"),d.textContent=t,b.textContent="Yes",b.onclick=function(e){e.target.onclick=null,i.removeChild(i.firstChild),r&&"function"===typeof r&&r()},i.appendChild(l),l.appendChild(o),o.appendChild(d),o.appendChild(u),u.appendChild(b),e){var f=document.createElement("div");f.classList.add("dialog-btn-1"),f.textContent="No",f.onclick=function(e){e.target.onclick=null,i.removeChild(i.firstChild),s&&"function"===typeof s&&s()},u.appendChild(f)}}}};var b=function(e){var t=e.onBack,n=e.searchText,r=e.filterValue,s=Object(c.useState)([]),i=Object(a.a)(s,2),b=i[0],f=i[1],j=Object(c.useState)([]),m=Object(a.a)(j,2),v=m[0],h=m[1],p=Object(c.useState)(""),O=Object(a.a)(p,2),x=O[0],g=O[1],y=Object(c.useRef)(),k=function(e){var t={url:"getHistory",body:{name:e}};u.request(t,(function(t){y.current.style.left="0",y.current.style.transform="translateX(0)",h(t.result.slice()),g(e)}))};return Object(c.useEffect)((function(){!function(){var e={url:"getRankList",body:{name:n.name,level:r}};u.request(e,(function(e){var t=e.result;r&&(t=t.filter((function(e){return e.level===r}))),n.name&&(t=t.filter((function(e){return e.name.toLowerCase().indexOf(n.name.toLowerCase())>-1}))),f(t)}))}()}),[n,r]),Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("div",{style:{display:"flex"},children:Object(l.jsxs)("div",{style:{display:"flex",position:"relative",left:"50%",transform:"translateX(-50%)"},children:[Object(l.jsxs)("div",{className:"rank-wrapper",ref:y,children:[Object(l.jsxs)("div",{className:"rank-header",children:[Object(l.jsx)("div",{children:"Rank"}),Object(l.jsx)("div",{className:"rank-name",children:"Name"}),Object(l.jsx)("div",{className:"rank-score",children:"Score"}),Object(l.jsx)("div",{className:"rank-date",children:"Date"}),Object(l.jsx)("div",{style:{margin:"0 auto"}}),Object(l.jsx)("div",{children:"Title"})]}),Object(l.jsx)("div",{className:"rank-box",children:Object(l.jsx)("div",{style:{height:"45vh"},children:b.map((function(e,t){return 1===e.rank&&(e.link="/rank1.png"),Object(l.jsx)(o,{rank:e,onRowClick:k},e.name)}))})})]}),v.length>0?Object(l.jsxs)("div",{style:{marginLeft:"20px"},children:[Object(l.jsxs)("div",{className:"rank-his-header",children:[Object(l.jsx)("div",{style:{margin:"0 auto"},children:"".concat(x)}),Object(l.jsx)("div",{className:"btn-x",onClick:function(){y.current.style.left="50%",y.current.style.transform="translateX(-50%)",h([])},children:"X"})]}),Object(l.jsx)("div",{className:"rank-his-box",children:v.map((function(e,t){return Object(l.jsx)(d,{item:e},t)}))})]}):null]})}),Object(l.jsx)("div",{className:"label1",onClick:function(){return t()},children:"Back"})]})};var f=function(e){var t=e.style,n=void 0===t?{}:t,c=e.title,r=void 0===c?"":c,s=e.children;return Object(l.jsx)("div",{style:n,children:Object(l.jsxs)("div",{className:"panel-box",children:[Object(l.jsx)("div",{className:"panel-title",children:r}),Object(l.jsx)("div",{className:"panel-content",children:s})]})})};var j=function(e){var t=e.onBack,n=Object(c.useState)([]),r=Object(a.a)(n,2),s=r[0],i=r[1],o=Object(c.useRef)(""),d=Object(c.useRef)(),b=Object(c.useRef)(),j=Object(c.useRef)(""),m=Object(c.useContext)(T),v="key-btn-sel",h=function(e){var t=e.currentTarget,n=t.id.indexOf("theme"),c=(-1===n?d.current:b.current).querySelector(".".concat(v));if(c?-1===n?(c.classList.toggle(v),c.id!==t.id&&t.classList.toggle(v)):c.id!==t.id&&(t.classList.add(v),c.classList.remove(v)):t.classList.toggle(v),n>-1){var r=document.querySelector("#root");"theme2"===t.id?(r.classList.add("dark"),o.current="dark"):(r.classList.remove("dark"),o.current=""),m.onChangeTheme(o.current)}},p=function(e){var t=d.current.querySelector(".".concat(v));if(t&&t.classList.contains(v)){var n=Number(t.id.split("key")[1]);i((function(t){return t[n]=e.key,t.slice()}))}},O=function(){var e={url:"getTheme",body:{name:m.session.id}};u.request(e,(function(e){var t=e.result[0]&&"dark"===e.result[0].theme?"theme2":"theme1";b.current.querySelector("#".concat(t)).classList.add(v),o.current=e.result[0]?e.result[0].theme:"light",j.current=e.result[0]?e.result[0].theme:"light"}))};return Object(c.useEffect)((function(){return function(){var e={url:"getKeySet",body:{name:m.session.id}};u.request(e,(function(e){var t=e.result[0]&&e.result[0].keyset,n=t?t.split("/"):["w","s","a","d","j"];i(n)}))}(),O(),document.addEventListener("keydown",p),function(){return document.removeEventListener("keydown",p)}}),[]),Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)("div",{className:"setting-box",children:[Object(l.jsxs)(f,{title:"Key Setting",style:{height:"280px",marginBottom:"20px"},children:[Object(l.jsxs)("div",{className:"keyset-box",ref:d,children:[Object(l.jsxs)("div",{children:["Rotate",Object(l.jsx)("div",{className:"key-btn",id:"key0",onClick:h,children:s[0]})]}),Object(l.jsxs)("div",{children:["Move down",Object(l.jsx)("div",{className:"key-btn",id:"key1",onClick:h,children:s[1]})]}),Object(l.jsxs)("div",{children:["Move left",Object(l.jsx)("div",{className:"key-btn",id:"key2",onClick:h,children:s[2]})]}),Object(l.jsxs)("div",{children:["Move right",Object(l.jsx)("div",{className:"key-btn",id:"key3",onClick:h,children:s[3]})]}),Object(l.jsxs)("div",{children:["Drop",Object(l.jsx)("div",{className:"key-btn",id:"key4",onClick:h,children:s[4]})]})]}),Object(l.jsxs)("div",{className:"setting-btn",children:[Object(l.jsx)("div",{className:"basic-btn-3",onClick:function(){u.confirm("Do you want to save?",(function(){var e={url:"saveKeySet",body:{name:m.session.id,keyset:s.join("/")}};u.request(e,(function(e){u.alert(e.errMsg||"Save complete!")}))}))},children:"Save"}),Object(l.jsx)("div",{className:"basic-btn-3",onClick:function(){i(["w","s","a","d","j"])},children:"Restore Default"})]})]}),Object(l.jsxs)(f,{title:"Theme Color",style:{height:"150px"},children:[Object(l.jsxs)("div",{className:"x-center",ref:b,style:{display:"flex",width:"fit-content"},children:[Object(l.jsx)("div",{className:"basic-btn-3",id:"theme1",onClick:h,children:"Light"}),Object(l.jsx)("div",{className:"basic-btn-3",id:"theme2",onClick:h,children:"Dark"})]}),Object(l.jsx)("div",{className:"setting-btn",children:Object(l.jsx)("div",{className:"basic-btn-3",onClick:function(){u.confirm("Do you want to save?",(function(){var e={url:"saveTheme",body:{name:m.session.id,theme:o.current}};u.request(e,(function(e){u.alert(e.errMsg||"Save complete!",(function(){O()}))}))}))},children:"Save"})})]})]}),Object(l.jsx)("div",{className:"label1",onClick:function(){m.onChangeTheme(j.current),t()},children:"Back"})]})};var m=function(e){var t=e.onSearch,n=e.style,r=void 0===n?{}:n,s=Object(c.useState)(""),i=Object(a.a)(s,2),o=i[0],d=i[1];return Object(l.jsx)("div",{style:r,children:Object(l.jsxs)("div",{className:"search-bar",children:[Object(l.jsx)("input",{className:"input-search",onChange:function(e){d(e.target.value)},onKeyDown:function(e){13===e.keyCode&&t(o)},value:o,placeholder:"Search by user name"}),Object(l.jsx)("div",{className:"search-btn",onClick:function(){t(o)},children:"\u27a4"})]})})};var v=function(e){var t=e.onSelected,n=e.items,c=void 0===n?[]:n,r=e.style,s=void 0===r?{}:r;return Object(l.jsx)("div",{style:s,children:Object(l.jsxs)("select",{className:"combobox",onChange:function(e){t(e.currentTarget.value)},children:[Object(l.jsx)("option",{value:"",children:"none"}),c.map((function(e,t){return Object(l.jsx)("option",{value:e,children:e},t)}))]})})};n(13);var h=function(e){var t=e.onSelect,n=e.level,r=void 0===n?[]:n,s=e.onRefresh,i=Object(c.useState)(!1),o=Object(a.a)(i,2),d=o[0],u=o[1],f=Object(c.useRef)("0"),h=Object(c.useRef)(),p=Object(c.useRef)(),O=Object(c.useState)(!0),x=Object(a.a)(O,2),g=x[0],y=x[1],k=Object(c.useState)(!0),N=Object(a.a)(k,2),C=N[0],S=N[1],w=Object(c.useState)(""),L=Object(a.a)(w,2),R=L[0],q=L[1],E=Object(c.useState)(""),T=Object(a.a)(E,2),M=T[0],I=T[1],D=function(e){"Back"===e.target.textContent?s():t(e.target)},A=function(){y(!0),S(!0),I(""),q(""),p.current.classList.toggle("title-min")};return Object(c.useEffect)((function(){return function(){clearInterval(f.current)}}),[]),Object(l.jsx)(l.Fragment,{children:Object(l.jsxs)("div",{className:"menu-box",children:[Object(l.jsx)("div",{className:"title",ref:p,children:"TETRIS"}),g&&C?Object(l.jsxs)("div",{children:[Object(l.jsxs)("div",{style:{marginTop:"15vh"},children:[Object(l.jsx)("div",{className:"label2",hidden:!d,ref:h,children:"Select level"}),Object(l.jsx)("div",{className:"label1",onClick:function(e){u(!0),f.current=setInterval((function(){if(h.current){var e=1e3*Math.random()%256,t=1e3*Math.random()%256,n=1e3*Math.random()%256;h.current.style.color="rgb(".concat(e,", ").concat(t,", ").concat(n,")")}}),500)},hidden:d,children:"Start"}),Object(l.jsx)("div",{className:"label1",onClick:function(){y(!1),p.current.classList.toggle("title-min")},hidden:d,children:"Ranking"}),Object(l.jsx)("div",{className:"label1",onClick:function(){S(!1),p.current.classList.toggle("title-min")},hidden:d,children:"Setting"})]}),d?Object(l.jsxs)("div",{className:"level-box",children:[r.map((function(e,t){return Object(l.jsx)("div",{className:"label3",onClick:D,children:e},t)})),Object(l.jsx)("div",{className:"label3",onClick:D,children:"Back"})]}):null]}):null,g?null:Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)("div",{style:{display:"flex",position:"relative",left:"50%",transform:"translateX(-50%)",width:"fit-content"},children:[Object(l.jsx)(m,{onSearch:function(e){q({name:e})},style:{marginRight:"5px"}}),Object(l.jsx)(v,{items:r,onSelected:function(e){I(e)}})]}),Object(l.jsx)(b,{onBack:A,searchText:R,filterValue:M})]}),C?null:Object(l.jsx)(j,{onBack:A})]})})},p=n(5);function O(e,t,n,c){var r=10*n,s=20*n,i=function(e){if(e){var t=e.querySelectorAll('[class*="block-color"]'),n=[],c=[];return t.forEach((function(e){n.push(e),c.push(e)})),n.sort((function(e,t){return e.getClientRects()[0].top-t.getClientRects()[0].top})),c.sort((function(e,t){return e.getClientRects()[0].left-t.getClientRects()[0].left})),{top:n.pop().getClientRects()[0].top||0,minLeft:c[0].getClientRects()[0].left||0,maxLeft:c.pop().getClientRects()[0].left||0,bodyInfo:document.querySelector("#body").getClientRects()[0]||0}}}(t),a=i.top,l=i.minLeft,o=i.maxLeft,d=i.bodyInfo;if(!e){switch(c){case N[1]:if(a-d.top+n>s)return!0;break;case N[2]:if(l-d.left-n<0)return!0;break;case N[3]:if(o-d.left+n>r)return!0}return!1}var u=d.left+7-l,b=o+n-(d.left+7+r),f=a-(d.top+7+s),j=0,m=Number(t.style.transform.split("(")[1].split("deg")[0]);if(u>0){j=0===Math.floor(u/n)?n:Math.floor(u/n)*n;for(var v=1;v<=j/n;v++)if(y(!1,t,n*(j/n),N[3]))return void(t.style.transform="rotate(".concat(m-90,"deg)"));t.style.left=Number(t.style.left.split("px")[0])+j+"px"}if(b>0){j=0===Math.floor(b/n)?n:Math.floor(b/n)*n;for(v=1;v<=j/n;v++)if(y(!1,t,n*(j/n),N[2]))return void(t.style.transform="rotate(".concat(m-90,"deg)"));t.style.left=Number(t.style.left.split("px")[0])-j+"px"}if(f>0){j=0===Math.floor(f/n)?n:Math.floor(f/n)*n;for(v=1;v<=j/n;v++)if(y(!1,t,n*(j/n),N[1]))return void(t.style.transform="rotate(".concat(m-90,"deg)"));t.style.top=Number(t.style.top.split("px")[0])-j+"px"}}function x(e){for(var t=e.querySelectorAll('[class*="block-color"]'),n=[],c=[],r=0;r<t.length;r++)n.push(t[r].getClientRects()[0]),c.push(t[r]);return{rect:n,bitObj:c}}function g(e,t,n,c,r,s,i){if(e.left>n&&e.left<r&&e.top>c&&e.top<s&&e.left>t.left&&e.left<t.left+10*i&&e.top>t.top&&e.top<t.top+20*i)return!0}function y(e,t,n,c){for(var r=document.querySelector("#body").getClientRects()[0],s=document.querySelectorAll("div.non-active"),i=x(t),a=i.rect,l=(i.bitObj,!1),o=0;o<s.length;o++)for(var d=x(s[o]),u=d.rect,b=(d.bitObj,0);b<a.length;b++)for(var f=0;f<u.length;f++)if(e){Number(t.style.left.split("px")[0]),Number(t.style.top.split("px")[0]);var j={left:a[b].left+n/2,top:a[b].top+n/2},m=Object(p.a)({},j),v=u[f].left-0,h=u[f].top-0;if(l=g(m,r,v,h,v+n+0,h+n+0,n))return!0}else{var O=n+n/2,y=n/2;switch(c){case N[1]:if(Math.abs(a[b].left-u[f].left)<=2&&a[b].top+O>u[f].top&&a[b].top+O<u[f].top+n)return!0;break;case N[2]:if(Math.abs(a[b].top-u[f].top)<=2&&a[b].left-y>u[f].left&&a[b].left-y<u[f].left+n)return!0;break;case N[3]:if(Math.abs(a[b].top-u[f].top)<=2&&a[b].left+O>u[f].left&&a[b].left+O<u[f].left+n)return!0}}return l}function k(e,t,n){for(var c=document.querySelectorAll("div.non-active"),r=n/2,s=t.getClientRects()[0].top+n*e,i=function(){var e=x(c[a]),t=e.rect,i=e.bitObj;for(l=0;l<t.length;l++)if(t[l].top+r>s&&t[l].top+r<s+n&&(i[l].classList.forEach((function(e){return i[l].classList.remove(e)})),i[l].classList.add("removed")),t[l].top+r<s){var o=i[l].parentNode.parentNode.style.transform,d=o.split("(").length>1?Number(o.split("(")[1].split("deg")[0]):0,u=i[l].style.top.split("px").length>1?Number(i[l].style.top.split("px")[0]):0,b=i[l].style.left.split("px").length>1?Number(i[l].style.left.split("px")[0]):0;switch(i[l].style.position="relative",d/90%4){case 0:i[l].style.top=u+n+"px";break;case 1:i[l].style.left=b+n+"px";break;case 2:i[l].style.top=u-n+"px";break;case 3:i[l].style.left=b-n+"px"}}},a=0;a<c.length;a++){var l;i()}}var N=[];var C=function(e){var t=e.size,n=void 0===t?10:t,r=e.level,s=void 0===r?"Easy":r,i=e.onGameOver,o=e.keyset,d=void 0===o?[N[0],N[1],N[2],N[3],N[4]]:o,u=Object(c.useRef)(),b=Math.floor(10*Math.random()%7+1),f=Object(c.useState)(0),j=Object(a.a)(f,2),m=j[0],v=j[1],h=Object(c.useState)(0),p=Object(a.a)(h,2),g=p[0],C=p[1],S=Object(c.useState)(0),w=Object(a.a)(S,2),L=w[0],R=w[1],q=Object(c.useRef)(""),E=Object(c.useRef)(),T=Object(c.useRef)(0),M=Object(c.useRef)(""),I=Object(c.useRef)(3),D=Object(c.useRef)();N=d.slice();var A=function(){var e=document.querySelector("div.active");if(e)if(O(!1,e,n,N[1])||y(!1,e,n,N[1])){clearInterval(q.current),q.current="",e.classList.remove("active"),e.classList.add("non-active");for(var t=1,c=function(e,t){for(var n=document.querySelectorAll("div.non-active"),c=t/2,r=[],s=1;s<=20;s++){for(var i=0,a=e.getClientRects()[0].top+t*s,l=0;l<n.length;l++)for(var o=x(n[l]).rect,d=0;d<o.length;d++)o[d].top+c>a&&o[d].top+c<a+t&&i++;10===i&&r.push(s)}return r}(u.current,n),r=0;r<c.length;r++)k(c[r],u.current,n);c.length>0&&(I.current>0&&(clearInterval(M.current),I.current=3),M.current=setInterval((function(){D.current&&(3==I.current&&(D.current.style.opacity=.9),I.current--,0==I.current&&(D.current.style.opacity=0,clearInterval(M.current),I.current=3,R(0)))}),1e3),R((function(e){return t=e+1,e+1}))),C((function(e){return e+10*c.length*t})),v((function(e){return e+1}))}else e.style.top=Number(e.style.top.split("px")[0])+n+"px"},B=function(e){var t=document.querySelector("div.active");if(t&&!O(!1,t,n,e.key)&&!y(!1,t,n,e.key)){var c=t.style,r=c.top,s=c.left,i=c.transform;switch(r=Number(r.split("px")[0]),s=Number(s.split("px")[0]),i=i.split("(").length>1?Number(i.split("(")[1].split("deg")[0]):0,e.key){case N[1]:t.style.top=r+n+"px";break;case N[2]:t.style.left=s-n+"px";break;case N[3]:t.style.left=s+n+"px";break;case N[0]:t.style.transform="rotate(".concat(i+90,"deg)");var a=Number(t.style.transform.split("(")[1].split("deg")[0]);y(!0,t,n)?t.style.transform="rotate(".concat(a-90,"deg)"):O(!0,t,n);break;case N[4]:for(var l=r+n;!O(!1,t,n,N[1])&&!y(!1,t,n,N[1]);)t.style.top=l+"px",l+=n}}};Object(c.useEffect)((function(){if(function(e,t){if(0==e.getClientRects().length)return!1;for(var n=e.getClientRects()[0],c=n.top,r=n.left,s=document.querySelectorAll("div.non-active"),i=t/2,a=r+2*t,l=r+8*t,o=0;o<s.length;o++)for(var d=x(s[o]).rect,u=0;u<d.length;u++)if(d[u].top+i>c&&d[u].top+i<c+t&&d[u].left+i>a&&d[u].left+i<l)return!0}(u.current,n))i({score:g,level:s}),u.current.style.filter="blur(6px)",E.current.hidden=!1,setTimeout((function(){return E.current.style.opacity=1}),50);else{0!==m&&m%30===0&&(T.current+=100);var e="Easy"===s?1e3-T.current:"Normal"===s?600-T.current:"Hard"===s?300-T.current:150-T.current;e<100&&(e=150),function(e,t,n,c,r,s,i){var a={b1:[[1,0],[1,0],[1,0],[1,0]],b2:[[1,0],[1,0],[1,1]],b3:[[1,1],[1,0],[1,0]],b4:[[1,0],[1,1],[0,1]],b5:[[0,1],[1,1],[1,0]],b6:[[1,1],[1,1]],b7:[[0,1],[1,1],[0,1]]},l=a["b"+t].length,o=document.createElement("div");o.style.width=l*n+"px",o.style.height=2*n+"px",o.style.position="relative",o.style.left=3*n+"px",o.style.transformOrigin=6===t?"".concat(n,"px ").concat(n,"px"):"".concat(n+n/2,"px ").concat(n/2,"px"),o.classList.add("active");for(var d=0;d<2;d++){var u=document.createElement("div");u.style.width=l*n+"px",u.style.height=n+"px",u.style.display="flex",o.appendChild(u)}for(d=0;d<a["b"+t].length;d++)for(var b=0;b<2;b++){var f=a["b"+t][d][b],j=document.createElement("div");j.style.cssText="width:".concat(n,"px; height:").concat(n,"px;"),1===f&&j.classList.add("block-color"+t),0===b?o.children[0].appendChild(j):o.children[1].appendChild(j)}e.current.appendChild(o),s>0&&(o.style.top="-".concat(2*n*s,"px")),c.current=setInterval(r,i)}(u,b,n,q,A,m,e)}}),[m]),Object(c.useEffect)((function(){return document.addEventListener("keydown",B),function(){document.removeEventListener("keydown",B),clearInterval(q.current)}}),[]);var P={width:10*n+"px",height:20*n+"px"};return Object(l.jsxs)("div",{children:[Object(l.jsxs)("div",{style:{height:"40px"},children:[Object(l.jsxs)("div",{style:{display:"flex"},children:[Object(l.jsxs)("div",{className:"score",children:["Score : ",g]}),Object(l.jsx)("div",{style:{margin:"0 auto"}}),Object(l.jsxs)("div",{className:"score",children:["Level : ",s]})]}),L>0?Object(l.jsxs)("div",{className:"combo",ref:D,children:[Object(l.jsx)("div",{className:"combo-number",children:L}),"Combo!"]}):null]}),Object(l.jsx)("div",{className:"game-over",ref:E,hidden:!0,children:"Game Over"}),Object(l.jsx)("div",{id:"body",className:"body-frame",ref:u,style:P})]})};var S=function(e){var t=e.themeColor,n=Object(c.useContext)(T),r="dark"===t?"dark-el":"";return Object(l.jsxs)("div",{className:"top-menu-bar ".concat(r),children:[Object(l.jsxs)("div",{className:"top-menu-text",children:['Welcome! "',n.session.id,'"']}),Object(l.jsx)("div",{className:"pusher"}),Object(l.jsx)("div",{className:"basic-btn-2",onClick:function(){n.onLogout()},children:"Logout"}),Object(l.jsx)("div",{className:"basic-btn-2",onClick:function(){alert("menu")},children:"Menu"})]})};var w=function(){var e=Object(c.useState)([]),t=Object(a.a)(e,2),n=t[0],r=t[1];return Object(c.useEffect)((function(){u.request({url:"getTopRanker"},(function(e){r(e.result.slice())}))}),[]),Object(l.jsxs)("div",{className:"footer",children:[Object(l.jsx)("div",{className:"footer-noti-text",style:{color:"black"},children:"Notice"}),Object(l.jsxs)("div",{className:"ani-move-left",style:{whiteSpace:"nowrap"},children:[Object(l.jsx)("span",{style:{marginRight:"12px",color:"black"},children:"Current Top Rankers"}),n.map((function(e,t){var n={marginRight:"10px",color:"Extreme"===e.level?"red":"Hard"===e.level?"#002bff":"Normal"===e.level?"green":"gray"};return Object(l.jsx)("span",{style:n,children:" ".concat(e.level," : ").concat(e.name)},t)})),Object(l.jsx)("span",{style:{color:"black"},children:"!"})]})]})};var L=function(){var e=Object(c.useContext)(T),t=Object(c.useState)(!1),n=Object(a.a)(t,2),r=n[0],s=n[1],i=Object(c.useState)(!0),o=Object(a.a)(i,2),d=o[0],b=o[1],f=Object(c.useState)(30),j=Object(a.a)(f,2),m=j[0],v=(j[1],Object(c.useState)("")),p=Object(a.a)(v,2),O=p[0],x=p[1],g=Object(c.useState)([]),y=Object(a.a)(g,2),k=y[0],N=y[1],L=Object(c.useRef)(),R=function(){for(var e=L.current.querySelectorAll("div.mainbody-side-btn"),t=0;t<e.length;t++)e[t].classList.add("mainbody-side-btn-move"),e[t].style.marginTop=15*t+"px"};return Object(c.useEffect)((function(){var t={url:"getTheme",body:{name:e.session.id}};u.request(t,(function(t){var n=t.result[0];n&&e.onChangeTheme(n.theme)}))}),[]),Object(l.jsxs)("div",{className:"frame",children:[Object(l.jsx)(S,{themeColor:e.themeColor}),r?null:Object(l.jsx)(h,{onSelect:function(t){var n=t.textContent;x(n);var c={url:"getKeySet",body:{name:e.session.id}};u.request(c,(function(e){var t=e.result[0]&&e.result[0].keyset?e.result[0].keyset.split("/"):["w","s","a","d","j"];N(t),s(!0),b(!1)}))},level:["Easy","Normal","Hard","Extreme"],onRefresh:function(){s(!0),setTimeout((function(){s(!1)}),50)}}),d?null:Object(l.jsxs)("div",{ref:L,style:{margin:"0 auto"},children:[Object(l.jsx)(C,{size:m,level:O,onGameOver:function(t){var n=t.score,c=t.level;setTimeout((function(){u.confirm("Would you like to record your score?",(function(){var t={url:"saveScore",body:{name:e.session.id,score:n,level:c,id:u.uuid()}};u.request(t,(function(e){e.errMsg?u.alert(e.errMsg,R):u.alert("Your score has been Recoded !",R)}))}),(function(){R()}))}),1500)},keyset:k}),Object(l.jsx)("div",{className:"label3 mainbody-side-btn",onClick:function(){b(!0),setTimeout((function(){b(!1)}),50)},children:"Restart"}),Object(l.jsx)("div",{className:"label3 mainbody-side-btn",onClick:function(){s(!1),b(!0)},children:"To menu"})]}),Object(l.jsx)(w,{})]})};var R=function(e){var t=e.onJoinEnd,n=Object(c.useState)(""),r=Object(a.a)(n,2),s=r[0],i=r[1],o=Object(c.useState)(""),d=Object(a.a)(o,2),b=d[0],f=d[1],j=Object(c.useState)(""),m=Object(a.a)(j,2),v=m[0],h=m[1],p=Object(c.useState)(""),O=Object(a.a)(p,2),x=O[0],g=O[1],y=Object(c.useRef)(),k=Object(c.useRef)(),N=function(e){var t=y.current.querySelectorAll("input[class=warn-input]");if(t.length>0){for(var n=0;n<t.length;n++)t[n].classList.remove("warn-input");k.current.style.visibility="hidden"}var c=e.target,r=c.value,s=c.name;"id"===s?i(r):"pw"===s?f(r):h(r)},C=function(e){"signup"===e.target.dataset.name?w():t()},S=function(e){13===e.keyCode&&w()},w=function(){var e=s.trim()?b.trim()?v.trim()?"":"pw_conf":"pw":"id";if(e){y.current.querySelector("input[name=".concat(e,"]")).classList.add("warn-input");var n="id"===e?"User Name":"pw"===e?"Password":"Password Confirm";return k.current.style.visibility="visible",void g("".concat(n," is empty."))}if(b!==v){for(var c=y.current.querySelectorAll("input[name*='pw']"),r=0;r<c.length;r++)c[r].classList.add("warn-input");return k.current.style.visibility="visible",void g("Passwords are not same.")}u.confirm("Would you like to register?",(function(){var e={url:"signup",body:{id:s,pw:b}};u.request(e,(function(e){if(e.errMsg){var n="exist"===e.errMsg?"'".concat(s,"' is already exist"):e.errMsg;u.alert(n)}else u.alert("You are registed.",(function(){t()}))}))}))};Object(c.useEffect)((function(){y.current.querySelector("input[name=id]").focus()}),[]);var L={top:"-60px"};return Object(l.jsxs)("div",{className:"login-box ani-vanish",ref:y,children:[Object(l.jsx)("div",{className:"welcome-title",children:"TETRIS"}),Object(l.jsx)("div",{className:"login-text text-theme",children:"Join to play"}),Object(l.jsx)("div",{className:"input-login",style:L,children:Object(l.jsx)("input",{name:"id",onChange:N,onKeyDown:S,placeholder:"User Name"})}),Object(l.jsx)("div",{className:"input-login",style:L,children:Object(l.jsx)("input",{name:"pw",onChange:N,onKeyDown:S,placeholder:"Password",type:"password"})}),Object(l.jsx)("div",{className:"input-login",style:L,children:Object(l.jsx)("input",{name:"pw_conf",onChange:N,onKeyDown:S,placeholder:"Password Confirm",type:"password"})}),Object(l.jsx)("div",{className:"login-button","data-name":"signup",onClick:C,style:L,children:"Sing up"}),Object(l.jsx)("div",{className:"warn-msg",ref:k,style:{top:"-55px"},children:x}),Object(l.jsx)("div",{className:"signin-text",style:{top:"-45px"},children:Object(l.jsx)("span",{"data-name":"sign",onClick:C,children:"Back"})})]})};var q=function(e){var t=e.onClickSignIn,n=e.onLogin,r=Object(c.useState)(""),s=Object(a.a)(r,2),i=s[0],o=s[1],d=Object(c.useState)(""),b=Object(a.a)(d,2),f=b[0],j=b[1],m=Object(c.useState)(""),v=Object(a.a)(m,2),h=v[0],p=v[1],O=Object(c.useRef)(),x=Object(c.useRef)(),g=function(e){var t=O.current.querySelector("input[class=warn-input]");t&&(t.classList.remove("warn-input"),x.current.style.visibility="hidden"),"id"===e.target.name?o(e.target.value):j(e.target.value)},y=function(e){"login"===e.target.dataset.name?N():t()},k=function(e){13===e.keyCode&&N()},N=function(){var e=i.trim()?f.trim()?"":"pw":"id";if(e){O.current.querySelector("input[name=".concat(e,"]")).classList.add("warn-input");var t="id"===e?"User Name":"Password";return x.current.style.visibility="visible",void p("".concat(t," is empty."))}var c={url:"login",body:{id:i,pw:f}};u.request(c,(function(e){var t=e.result;e.data;0===t.length?u.alert("Check User Name or Password again."):n(i)}))};return Object(c.useEffect)((function(){O.current.querySelector("input[name=id]").focus()}),[]),Object(l.jsxs)("div",{className:"login-box",ref:O,children:[Object(l.jsx)("div",{className:"welcome-title",children:"TETRIS"}),Object(l.jsx)("div",{className:"login-text text-theme",children:"Login to play"}),Object(l.jsx)("div",{className:"input-login",children:Object(l.jsx)("input",{name:"id",onChange:g,onKeyDown:k,placeholder:"User Name"})}),Object(l.jsx)("div",{className:"input-login",children:Object(l.jsx)("input",{name:"pw",onChange:g,onKeyDown:k,placeholder:"Password",type:"password"})}),Object(l.jsx)("div",{className:"login-button","data-name":"login",onClick:y,children:"Login"}),Object(l.jsx)("div",{className:"warn-msg",ref:x,children:h}),Object(l.jsxs)("div",{className:"signin-text",children:[Object(l.jsx)("span",{style:{color:"var(--inactive-color)",fontSize:"15px",marginRight:"8px"},children:"New here?"}),Object(l.jsx)("span",{"data-name":"sign",onClick:y,children:"Sing up"})]})]})};n(14);var E=function(e){var t=e.onLoginSuccess,n=Object(c.useState)(!1),r=Object(a.a)(n,2),s=r[0],i=r[1];return Object(l.jsxs)("div",{className:"background-theme",children:[s?null:Object(l.jsx)(q,{onClickSignIn:function(){i(!0)},onLogin:function(e){t(e)}}),s?Object(l.jsx)(R,{onJoinEnd:function(){i(!1)}}):null]})},T=r.a.createContext(null);var M=function(){var e=Object(c.useState)({id:sessionStorage.getItem("user_id")||null,login:sessionStorage.getItem("login")||!1}),t=Object(a.a)(e,2),n=t[0],r=t[1],s=Object(c.useState)(""),i=Object(a.a)(s,2),o=i[0],d=i[1];return Object(c.useEffect)((function(){u.request({url:"getToken",method:"GET"},(function(e){document.querySelector("meta[name=_csrf]").content=e.data.token}))}),[]),Object(l.jsx)("div",{className:"no-drag",style:{height:"100vh"},children:Object(l.jsxs)(T.Provider,{value:{session:n,onLogout:function(){u.confirm("Do you wnat to logout?",(function(){document.querySelector("#root").classList.remove("dark"),sessionStorage.clear(),r({id:null,login:!1}),d("")}))},themeColor:o,onChangeTheme:function(e){"dark"===e?(document.querySelector("#root").classList.add(e),document.styleSheets[2].rules[11].style.backgroundColor="var(--theme-black2)"):(document.querySelector("#root").classList.remove("dark"),document.styleSheets[2].rules[11].style.backgroundColor="white"),d(e)}},children:[n.login?Object(l.jsx)(L,{}):null,n.login?null:Object(l.jsx)(E,{onLoginSuccess:function(e){sessionStorage.setItem("user_id",e),sessionStorage.setItem("login",!0),r({id:e,login:!0})}})]})})},I=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,16)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),s(e),i(e)}))};i.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(M,{})}),document.getElementById("root")),I()}],[[15,1,2]]]);
//# sourceMappingURL=main.e0dd616f.chunk.js.map